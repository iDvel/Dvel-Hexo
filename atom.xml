<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dvel&#39;s Blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://Dvel.org/"/>
  <updated>2017-04-25T06:06:33.000Z</updated>
  <id>https://Dvel.org/</id>
  
  <author>
    <name>Dvel</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>UIScrollView中使用Masonry</title>
    <link href="https://Dvel.org/p/6/"/>
    <id>https://Dvel.org/p/6/</id>
    <published>2017-04-25T05:12:11.000Z</published>
    <updated>2017-04-25T06:06:33.000Z</updated>
    
    <content type="html"><![CDATA[<p>昨天耽误了一阵子在scrollView的布局上，记录一下。</p>
<p>如果可以提前确定<code>scrollView</code>的<code>contentSize</code>，就简单多了，但这种情况很少。</p>
<p>一般还是按照<code>subViews</code>自适应的比较合适，这样就需要一个<code>containerView</code>来撑起<code>scrollView</code>的<code>contentSize</code>。</p>
<h1 id="简单的代码示例："><a href="#简单的代码示例：" class="headerlink" title="简单的代码示例："></a>简单的代码示例：</h1><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">UIScrollView *scrollView = [UIScrollVie new];</div><div class="line">[self.view addSubview:scrollView];</div><div class="line">                            </div><div class="line">UIView *containerView = [UIView new];</div><div class="line">[scrollView addSubview:containerView];</div><div class="line">                            </div><div class="line">UIView *v1 = [UIView new];</div><div class="line">v1.backgroundColor = [UIColor redColor];</div><div class="line">[containerView addSubview:v1];</div><div class="line">                            </div><div class="line">UIView *v2 = [UIView new];</div><div class="line">v2.backgroundColor = [UIColor blueColor];</div><div class="line">[containerView addSubview:v2];</div><div class="line">                </div><div class="line">/*</div><div class="line">如上，我想让v1、v2纵向排列，让scrollView可以上下滚动。</div><div class="line">*/</div><div class="line"></div><div class="line">// scrollView正常进行约束</div><div class="line">[scrollView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.edges.equalTo(self.view);</div><div class="line">&#125;];</div><div class="line">                      </div><div class="line">// 容器视图</div><div class="line">[containerView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.edges.width.equalTo(scrollView); // 试了发现这里好像必须要约束一下width</div><div class="line">&#125;];</div><div class="line">                      </div><div class="line">// v1、v2都放在容器里</div><div class="line">[v1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.top.left.right.equalTo(containerView);</div><div class="line">    make.height.equalTo(@400);</div><div class="line">&#125;];</div><div class="line">[v2 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.top.equalTo(v1.mas_bottom);</div><div class="line">    make.left.right.equalTo(v1);</div><div class="line">    make.height.equalTo(@400);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 这里需要补刀，来撑起contentSize</div><div class="line">[containerView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.bottom.equalTo(v2);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;昨天耽误了一阵子在scrollView的布局上，记录一下。&lt;/p&gt;
&lt;p&gt;如果可以提前确定&lt;code&gt;scrollView&lt;/code&gt;的&lt;code&gt;contentSize&lt;/code&gt;，就简单多了，但这种情况很少。&lt;/p&gt;
&lt;p&gt;一般还是按照&lt;code&gt;subViews&lt;
    
    </summary>
    
    
      <category term="iOS" scheme="https://Dvel.org/tags/iOS/"/>
    
      <category term="ScrollView" scheme="https://Dvel.org/tags/ScrollView/"/>
    
      <category term="Masonry" scheme="https://Dvel.org/tags/Masonry/"/>
    
  </entry>
  
  <entry>
    <title>解决CocoaPod的类库import没有提示</title>
    <link href="https://Dvel.org/p/5/"/>
    <id>https://Dvel.org/p/5/</id>
    <published>2017-04-24T05:19:34.000Z</published>
    <updated>2017-04-25T05:12:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>网上搜了一些，添加<code>$(PODS_ROOT)</code>到 <strong>User Header Search Paths</strong> 就行了。</p>
<p>但是提示中会多出一些不想要的东西。</p>
<p>改成这个就好了：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$(PODS_ROOT)/Headers/Public</div></pre></td></tr></table></figure>
<p>图：</p>
<p><img src="https://i.v2ex.co/19qZI4ms.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;网上搜了一些，添加&lt;code&gt;$(PODS_ROOT)&lt;/code&gt;到 &lt;strong&gt;User Header Search Paths&lt;/strong&gt; 就行了。&lt;/p&gt;
&lt;p&gt;但是提示中会多出一些不想要的东西。&lt;/p&gt;
&lt;p&gt;改成这个就好了：&lt;/p&gt;
&lt;figure c
    
    </summary>
    
    
      <category term="iOS" scheme="https://Dvel.org/tags/iOS/"/>
    
      <category term="CocoaPod" scheme="https://Dvel.org/tags/CocoaPod/"/>
    
  </entry>
  
  <entry>
    <title>iOS使用CocoaPod的快速回顾</title>
    <link href="https://Dvel.org/p/4/"/>
    <id>https://Dvel.org/p/4/</id>
    <published>2017-04-17T08:45:51.000Z</published>
    <updated>2017-04-17T09:58:14.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>Mac自带Ruby环境，查看：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ gem -v</div></pre></td></tr></table></figure>
<p>通过surge等工具实现终端科学上网，或更改gem源。</p>
<p>安装 &amp; 更新 Pod：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ sudo gem install cocoapods</div></pre></td></tr></table></figure>
<p>确认：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ pod --version</div></pre></td></tr></table></figure>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>进入工程根目录，创建<code>Podfile</code>文件。</p>
<p>写入：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">platform :ios, &apos;8.0&apos;</div><div class="line">target &apos;svnt&apos; do</div><div class="line">pod &apos;AFNetworking&apos;, &apos;~&gt; 3.0&apos;</div><div class="line">end</div></pre></td></tr></table></figure>
<p>即最低支持iOS 8，第三方框架AFN的版本为3.0。</p>
<p><code>cd</code>进<code>Podfile</code>所在目录，进行安装第三方库：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ pod install</div></pre></td></tr></table></figure>
<h1 id="后续使用"><a href="#后续使用" class="headerlink" title="后续使用"></a>后续使用</h1><p>查询框架是否有新版本：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ pod outdated</div></pre></td></tr></table></figure>
<p>更新框架：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ pod update</div></pre></td></tr></table></figure>
<h1 id="参考-amp-感谢"><a href="#参考-amp-感谢" class="headerlink" title="参考&amp;感谢"></a>参考&amp;感谢</h1><ul>
<li><a href="http://www.jianshu.com/p/82d0ba43f8c3" rel="external nofollow noopener noreferrer" target="_blank">iOS开发 - CocoaPods安装和使用教程</a></li>
<li><a href="http://www.jianshu.com/p/689368568cf7" rel="external nofollow noopener noreferrer" target="_blank">CocoaPods相关问题总结</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; class=&quot;headerlink&quot; title=&quot;安装&quot;&gt;&lt;/a&gt;安装&lt;/h1&gt;&lt;p&gt;Mac自带Ruby环境，查看：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td cla
    
    </summary>
    
    
      <category term="iOS" scheme="https://Dvel.org/tags/iOS/"/>
    
      <category term="CocoaPod" scheme="https://Dvel.org/tags/CocoaPod/"/>
    
  </entry>
  
  <entry>
    <title>GCE搭建SS</title>
    <link href="https://Dvel.org/p/3/"/>
    <id>https://Dvel.org/p/3/</id>
    <published>2017-03-27T05:50:20.000Z</published>
    <updated>2017-03-28T03:38:58.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GCE搭建SS"><a href="#GCE搭建SS" class="headerlink" title="GCE搭建SS"></a>GCE搭建SS</h1><p>目前是300美元、12月试用活动，所以来体验一下。</p>
<p>之前试用，选择了asia-east1-c区，发现速度并不理想，我本人是北京联通。</p>
<p>后来发现是IP坑爹，35开头的对我效果很不理想，开到了130或104开头的IP后ping基本在60以内。</p>
<h1 id="信用卡"><a href="#信用卡" class="headerlink" title="信用卡"></a>信用卡</h1><p>国内部分双币卡无法验证。</p>
<p>后来在知乎上看有个哥们花5块钱淘宝买了张美国信用卡成功了。。。</p>
<h1 id="GCE"><a href="#GCE" class="headerlink" title="GCE"></a>GCE</h1><ul>
<li>注意防火墙是自动开启的，在『网络』 - 『防火墙规则』添加规则。</li>
<li>亲测<a href="https://teddysun.com/489.html" rel="external nofollow noopener noreferrer" target="_blank">秋水逸冰的一键BBR脚本</a>在GCE的CentOS7中无法使用，重启后变成read-only file system，可以换Ubuntu，但是不换BBR速度也很快了。</li>
<li>然后推荐秋水逸冰的<a href="https://teddysun.com/" rel="external nofollow noopener noreferrer" target="_blank">SS一键脚本</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;GCE搭建SS&quot;&gt;&lt;a href=&quot;#GCE搭建SS&quot; class=&quot;headerlink&quot; title=&quot;GCE搭建SS&quot;&gt;&lt;/a&gt;GCE搭建SS&lt;/h1&gt;&lt;p&gt;目前是300美元、12月试用活动，所以来体验一下。&lt;/p&gt;
&lt;p&gt;之前试用，选择了asia-east
    
    </summary>
    
    
      <category term="GCE" scheme="https://Dvel.org/tags/GCE/"/>
    
      <category term="SS" scheme="https://Dvel.org/tags/SS/"/>
    
  </entry>
  
  <entry>
    <title>GitBook简单生成本地静态HTML的方法</title>
    <link href="https://Dvel.org/p/2/"/>
    <id>https://Dvel.org/p/2/</id>
    <published>2017-02-23T14:23:27.000Z</published>
    <updated>2017-02-23T14:27:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>偶尔可能要写一些生成本地文件发给朋友看，所以。。。</p>
<h1 id="简单生成本地静态HTML的方法"><a href="#简单生成本地静态HTML的方法" class="headerlink" title="简单生成本地静态HTML的方法"></a>简单生成本地静态HTML的方法</h1><ul>
<li>安装：<code>$ npm install gitbook-cli -g</code></li>
</ul>
<ul>
<li>生成：<code>$ gitbook build</code></li>
</ul>
<ul>
<li>结果：左侧目录无法点击。</li>
</ul>
<ul>
<li><code>$ gitbook serve</code> 可通过localhost访问，没有任何问题。</li>
</ul>
<p><strong>问题：</strong></p>
<p>自某版本后<code>$ gitbook build</code>生成的 website 不支持 local 打开了，具体哪个版本未实践。</p>
<p><strong>解决办法：</strong></p>
<p><code>$ gitbook build --gitbook=2.6.7</code></p>
<p>使用2.6.7版本，会自动安装并生成，左侧目录可点击，Firefox、Chrome暂无任何问题。</p>
<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><p><strong>帮助</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ gitbook help</div></pre></td></tr></table></figure>
<p><strong>更新</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ gitbook update</div></pre></td></tr></table></figure>
<p><strong>生成静态网页</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ gitbook build</div><div class="line">$ gitbook build --gitbook=2.6.7 // 生成对应版本的，本地无此版本会自动下载</div></pre></td></tr></table></figure>
<p><strong>生成静态网页并运行到服务器</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ gitbook serve</div></pre></td></tr></table></figure>
<p><strong>列出远程所有可用版本</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ gitbook ls-remote</div></pre></td></tr></table></figure>
<p><strong>列出本地所有已安装版本</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ gitbook ls</div></pre></td></tr></table></figure>
<p><strong>卸载本地某版本</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ gitbook uninstall x.x.x</div></pre></td></tr></table></figure>
<h1 id="参考-amp-感谢"><a href="#参考-amp-感谢" class="headerlink" title="参考&amp;感谢"></a>参考&amp;感谢</h1><p><a href="https://github.com/zhangjikai/gitbook-use" rel="external nofollow noopener noreferrer" target="_blank">hangjikai/gitbook-use</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;偶尔可能要写一些生成本地文件发给朋友看，所以。。。&lt;/p&gt;
&lt;h1 id=&quot;简单生成本地静态HTML的方法&quot;&gt;&lt;a href=&quot;#简单生成本地静态HTML的方法&quot; class=&quot;headerlink&quot; title=&quot;简单生成本地静态HTML的方法&quot;&gt;&lt;/a&gt;简单生成本地静态
    
    </summary>
    
    
      <category term="GitBook" scheme="https://Dvel.org/tags/GitBook/"/>
    
  </entry>
  
  <entry>
    <title>为Hexo博客弄一个图床，再搭配一个神器</title>
    <link href="https://Dvel.org/p/1/"/>
    <id>https://Dvel.org/p/1/</id>
    <published>2016-11-27T18:17:30.000Z</published>
    <updated>2017-01-07T15:01:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>图床的优点：一次上传，到处使用。</p>
<p>Markdown编辑器、自己的博客、论坛、Quiver这类的笔记本里，看图都是简单明了的。</p>
<h2 id="图床"><a href="#图床" class="headerlink" title="图床"></a>图床</h2><p>七牛、又拍、阿里云</p>
<p>新浪、imgur、sm.ms</p>
<p>很多随便选，按需求决定，我用的V2EX的，因为我图片量不大。</p>
<h2 id="图床神器-iPic"><a href="#图床神器-iPic" class="headerlink" title="图床神器 iPic"></a>图床神器 iPic</h2><p>在选择好图床后，还发现一个超级好用的软件——</p>
<p><img src="https://i.v2ex.co/933WxxrL.jpeg" alt="iPic"></p>
<p>总之就是搭配Markdown的神器啦。</p>
<ul>
<li>支持拖动上传</li>
<li>自动生成Markdown语法，插图方便</li>
<li>支持众多图床，基本主流的都支持啦</li>
<li>最神奇的出现啦：<a href="https://toolinbox.net/iPic/iPicUploader_Typora.html" rel="external nofollow noopener noreferrer" target="_blank">Typora集成了iPic的上传服务</a></li>
</ul>
<p>具体的看这里吧：<a href="https://toolinbox.net/iPic/" rel="external nofollow noopener noreferrer" target="_blank"> 图床神器 iPic </a></p>
<p><em>特效</em>，注意看地址：</p>
<p><img src="https://i.v2ex.co/dNQ05ykt.gif" alt="Typora iPic"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;图床的优点：一次上传，到处使用。&lt;/p&gt;
&lt;p&gt;Markdown编辑器、自己的博客、论坛、Quiver这类的笔记本里，看图都是简单明了的。&lt;/p&gt;
&lt;h2 id=&quot;图床&quot;&gt;&lt;a href=&quot;#图床&quot; class=&quot;headerlink&quot; title=&quot;图床&quot;&gt;&lt;/a&gt;图床&lt;
    
    </summary>
    
    
      <category term="Hexo" scheme="https://Dvel.org/tags/Hexo/"/>
    
      <category term="图床" scheme="https://Dvel.org/tags/%E5%9B%BE%E5%BA%8A/"/>
    
      <category term="iPic" scheme="https://Dvel.org/tags/iPic/"/>
    
  </entry>
  
  <entry>
    <title>你好, Hexo!</title>
    <link href="https://Dvel.org/p/0/"/>
    <id>https://Dvel.org/p/0/</id>
    <published>2016-11-26T16:48:36.000Z</published>
    <updated>2017-01-17T19:19:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>updated: 2017-01-18</p>
<p>因为之前的WordPress博客域名被墙，加上Hexo正好满足于简单的书写要求，所以更换为Hexo。</p>
<p>主要还是记录了自己的搭建过程，因为对Linux不太熟悉，以备忘为主。</p>
<p>后面换到了coding pages上搭建，主要是简单方便省心，自带了https，速度也凑合。</p>
<h1 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h1><h2 id="本地搭建"><a href="#本地搭建" class="headerlink" title="本地搭建"></a>本地搭建</h2><h3 id="安装node-js"><a href="#安装node-js" class="headerlink" title="安装node.js"></a>安装node.js</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ brew install node</div></pre></td></tr></table></figure>
<h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><p>先cd进入创建好的hexo目录：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ sudo npm install -g hexo-cli</div><div class="line">$ hexo init</div><div class="line">$ npm install</div><div class="line">$ hexo d -fg</div><div class="line">$ hexo serve</div></pre></td></tr></table></figure>
<p>打开<a href="http://localhost:4000如果看到hexo的初始页面证明安装成功。" rel="external nofollow noopener noreferrer" target="_blank">http://localhost:4000如果看到hexo的初始页面证明安装成功。</a></p>
<h3 id="ssh秘钥"><a href="#ssh秘钥" class="headerlink" title="ssh秘钥"></a>ssh秘钥</h3><p>一路回车生成公钥和私钥：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">ssh-keygen -t rsa -C &quot;email@example.com&quot;</div></pre></td></tr></table></figure>
<p>之后在本地目录<code>~/.ssh/</code>下可以看到私钥<code>id_rsa</code>和公钥<code>id_rsa.pub</code>已经生成。</p>
<p>安装ssh-copy-id等会用，方便上传公钥。<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">brew install ssh-copy-id</div></pre></td></tr></table></figure></p>
<h2 id="VPS端搭建"><a href="#VPS端搭建" class="headerlink" title="VPS端搭建"></a>VPS端搭建</h2><h3 id="更新与安装（centOS）"><a href="#更新与安装（centOS）" class="headerlink" title="更新与安装（centOS）"></a>更新与安装（centOS）</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">yum update</div><div class="line">yum install nginx -y</div><div class="line">yum install git-core</div></pre></td></tr></table></figure>
<h3 id="创建git用户及设置ssh免密码登陆"><a href="#创建git用户及设置ssh免密码登陆" class="headerlink" title="创建git用户及设置ssh免密码登陆"></a>创建git用户及设置ssh免密码登陆</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">adduser git</div><div class="line">passwd git</div><div class="line">chmod 740 /etc/sudoers</div><div class="line">vim /etc/sudoers</div><div class="line">(提示没有安装vim的可以用vi命令，或安装vim:)</div><div class="line">yum -y install vim*</div></pre></td></tr></table></figure>
<p>在编辑器中找到以下内容并添加一行：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">## Allow root to run any commands anywhere</div><div class="line">root    ALL=(ALL)     ALL</div><div class="line">git     ALL=(ALL)     ALL (这行是添加的)</div></pre></td></tr></table></figure>
<p>保存退出并执行：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">chmod 440 /etc/sudoers</div></pre></td></tr></table></figure>
<p>接下来切到本地的终端，上传公钥：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ ssh-copy-id -i ~/.ssh/id_rsa.pub git@123.123.123.123</div></pre></td></tr></table></figure>
<p>测试一下，如果<code>$ ssh git@VPS的IP地址</code>,能够免密码登录的话，则表示成功。  </p>
<h3 id="回到VPS，创建git仓库"><a href="#回到VPS，创建git仓库" class="headerlink" title="回到VPS，创建git仓库:"></a>回到VPS，创建git仓库:</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">su git</div><div class="line">cd ~</div><div class="line">mkdir hexo.git &amp;&amp; cd hexo.git</div><div class="line">git init --bare</div></pre></td></tr></table></figure>
<h3 id="创建网站目录并赋予git对网站目录的所有权"><a href="#创建网站目录并赋予git对网站目录的所有权" class="headerlink" title="创建网站目录并赋予git对网站目录的所有权"></a>创建网站目录并赋予git对网站目录的所有权</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">su root</div><div class="line">cd /var/www</div><div class="line">mkdir hexo</div><div class="line">chown git:git -R /var/www/hexo</div></pre></td></tr></table></figure>
<h3 id="配置git-hooks"><a href="#配置git-hooks" class="headerlink" title="配置git hooks"></a>配置git hooks</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">su git</div><div class="line">cd /home/git/hexo.git/hooks</div><div class="line">vim post-receive</div></pre></td></tr></table></figure>
<p>写入以下内容：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">GIT_REPO=/home/git/hexo.git #git仓库</div><div class="line">TMP_GIT_CLONE=/tmp/hexo</div><div class="line">PUBLIC_WWW=/var/www/hexo #网站目录</div><div class="line">rm -rf $&#123;TMP_GIT_CLONE&#125;</div><div class="line">git clone $GIT_REPO $TMP_GIT_CLONE</div><div class="line">rm -rf $&#123;PUBLIC_WWW&#125;/*</div><div class="line">cp -rf $&#123;TMP_GIT_CLONE&#125;/* $&#123;PUBLIC_WWW&#125;</div></pre></td></tr></table></figure>
<p>然后赋予脚本的执行权限</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">chmod +x post-receive</div></pre></td></tr></table></figure>
<h3 id="配置Nginx"><a href="#配置Nginx" class="headerlink" title="配置Nginx"></a>配置Nginx</h3><p>启动nginX:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">systemctl status nginx.service      // 查看服务当前状态</div><div class="line">systemctl start nginx.service       // 启动nginx服务</div><div class="line">systemctl restart nginx.service     // 重新启动服务</div><div class="line"></div><div class="line">systemctl enable nginx.service      // 设置开机自启动</div><div class="line">systemctl disable nginx.service     // 停止开机自启动</div><div class="line"></div><div class="line">systemctl list-units --type=service // 查看所有已启动的服务</div></pre></td></tr></table></figure>
<p>然后：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">vim /etc/nginx/conf.d/hexo.conf</div></pre></td></tr></table></figure>
<p>插入如下代码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen         80 ;</div><div class="line">    root /var/www/hexo;//这里可以改成你的网站目录地址，我将网站放在/var/www/hexo</div><div class="line">    server_name example.com www.example.com;//这里输入你的域名或IP地址</div><div class="line">    access_log  /var/log/nginx/hexo_access.log;</div><div class="line">    error_log   /var/log/nginx/hexo_error.log;</div><div class="line">    location ~* ^.+\.(ico|gif|jpg|jpeg|png)$ &#123;</div><div class="line">            root /var/www/hexo;</div><div class="line">            access_log   off;</div><div class="line">            expires      1d;</div><div class="line">    &#125;</div><div class="line">    location ~* ^.+\.(css|js|txt|xml|swf|wav)$ &#123;</div><div class="line">        root /var/www/hexo;</div><div class="line">        access_log   off;</div><div class="line">        expires      10m;</div><div class="line">    &#125;</div><div class="line">    location / &#123;</div><div class="line">        root /var/www/hexo;//这里可以改成你的网站目录地址，我将网站放在/var/www/hexo</div><div class="line">        if (-f $request_filename) &#123;</div><div class="line">            rewrite ^/(.*)$  /$1 break;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后重启nginx，此时刷新网页应该显示的是403。</p>
<h2 id="本机的最后配置"><a href="#本机的最后配置" class="headerlink" title="本机的最后配置"></a>本机的最后配置</h2><p>位于<code>hexo</code>文件夹下，<code>_config.yml</code>,修改<code>deploy</code>选项，例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  message: update  # 这个可以不写，会默认生成update日期</div><div class="line">  repo: git@123.123.123.123:hexo.git,master # 逗号后面写分支</div></pre></td></tr></table></figure>
<p>部署到多个仓库可以这么写：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">deploy: </div><div class="line">  - type: git</div><div class="line">    repo: git@git.coding.net:Dvel/Dvel.git,master</div><div class="line">  - type: git</div><div class="line">    repo: git@github.com:iDvel/Dvel-Hexo.git,master</div></pre></td></tr></table></figure>
<p>每次更新博客也可以让github上长点绿草了。。。</p>
<p>接下来安装<strong>hexo-deployer-git</strong>，否则部署时会报这个错”<em>ERROR Deployer not found: git</em>“。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ npm install hexo-deployer-git --save</div></pre></td></tr></table></figure>
<p>接着<code>$ hexo g &amp;&amp; hexo d</code>，如果一切正常，静态文件已经被成功的push到了blog的仓库里。</p>
<p>期间我忘了还出了个什么错，删除<code>hexo</code>目录下的<code>.deploy_git</code>后再次<code>hexo g &amp;&amp; hexo d</code>就可以了。</p>
<p>以上，博客已经完全建好了。</p>
<p><code>$ hexo generate</code>是生成静态文件。</p>
<p><code>$ hexo deploy</code>是部署，我们这里选择了Git，Hexo还支持其他部署形式。</p>
<p>所以每次写完文章，执行这两个命令后，就对网站完成了更新。</p>
<p>简化操作就是：<code>$ hexo g &amp;&amp; hexo d</code> ，再简化就是<code>$ hexo d -g</code>，效果一样。</p>
<h1 id="方法二，利用一键安装包"><a href="#方法二，利用一键安装包" class="headerlink" title="方法二，利用一键安装包"></a>方法二，利用一键安装包</h1><p>因为不太熟悉Linux，所以我选择了一键安装包，多站点管理方便些。</p>
<p>我用的这个 -&gt; <a href="https://oneinstack.com/" rel="external nofollow noopener noreferrer" target="_blank">OneinStack官网</a></p>
<p>步骤和上面差不多，但是很多路径要改一下，也可以很简单的搭建出Hexo。</p>
<h1 id="方法三，coding-pages"><a href="#方法三，coding-pages" class="headerlink" title="方法三，coding pages"></a>方法三，coding pages</h1><ol>
<li><p>coding中创建项目</p>
</li>
<li><p>站点配置文件<code>_config.yml</code>中<code>deploy</code>中写好coding项目的git地址</p>
</li>
<li><p>push上去：<code>$ hexo d -g</code></p>
</li>
<li><p>在coding上你的项目，开启Pages服务：可以自定义分支，绑定域名，开启https</p>
</li>
<li><p>大功告成</p>
<p>​</p>
</li>
</ol>
<p>这个相对简单一些，Coding Pages服务目前提供100M空间的支持，一般来说没有写文章的话，生成的<code>public</code>文件夹大约小于5M。</p>
<p>100M基本够写很多年的博客，至于图片应该另寻图床，不要放到coding上，否则空间很快用完。</p>
<h1 id="编写文章、更新博客"><a href="#编写文章、更新博客" class="headerlink" title="编写文章、更新博客"></a>编写文章、更新博客</h1><p>使用一款 MarkDown 编辑器写文章 ，写完后将文件以 *.md 的格式保存在本地<code>[网站目录]\source_posts</code>中。</p>
<p>MD编辑器，强烈安利Typora。</p>
<p>每篇 Blog 都有固定的参数必须填写，参数如下，注意每个参数的 : 后都有一个空格。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">title: title</div><div class="line">date: yyyy-mm-dd</div><div class="line">categories: category  </div><div class="line">tags: tag</div><div class="line">#多标签请这样写：  </div><div class="line">#tags: [tag1,tag2,tag3]</div><div class="line">#或者这样写： </div><div class="line">#tags:</div><div class="line">#- tag1 </div><div class="line">#- tag2  </div><div class="line">#- tag3  </div><div class="line">---  </div><div class="line">正文</div></pre></td></tr></table></figure>
<p>或者使用<code>$ hexo new</code>命令，具体官网有详细说明。</p>
<p>编写完后，只需要在hexo文件夹下执行<code>hexo g &amp;&amp; hexo d</code>，博客即可更新。</p>
<h1 id="遇到的坑"><a href="#遇到的坑" class="headerlink" title="遇到的坑"></a>遇到的坑</h1><p>设置了ssh免密码登陆后，依然需要密码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">这整段是以前使用的方法，过时了。。。</div><div class="line">设置ssh免密码登陆：</div><div class="line">su git</div><div class="line">cd ~</div><div class="line">mkdir .ssh &amp;&amp; cd .ssh</div><div class="line">touch authorized_keys</div><div class="line">vim authorized_keys  //在这个文件中粘贴进刚刚申请的key（在id_rsa.pub文件中）</div><div class="line">设置权限：</div><div class="line">chmod o-w ~/</div><div class="line">chmod 700 ~/.ssh</div><div class="line">chmod 600 ~/.ssh/authorized_keys</div><div class="line"></div><div class="line">测试免密码登陆</div><div class="line">ssh -vvT git@123.123.123.123   // 你的VPS的IP地址</div><div class="line">发现依然需要密码，搜了好几天没找到解决办法，后来采用了ssh-copy-id，解决了这个问题。</div></pre></td></tr></table></figure>
<p>如果过程中重新初始化过VPS的磁盘，ssh连接VPS的时候可能会提示<code>Host key verification failed.</code>。<br>运行此命令即可：<code>$ ssh-keygen -R 123.123.123.123</code>，将123.123.123.123改成你的VPS的IP。<br>或者简单粗暴直接删除<code>known_hosts</code>文件。</p>
<h1 id="参考-amp-感谢"><a href="#参考-amp-感谢" class="headerlink" title="参考&amp;感谢"></a>参考&amp;感谢</h1><ul>
<li><a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo官网</a></li>
<li><a href="http://tiktoking.github.io/2016/01/26/hexo/#u521B_u5EFA_u7F51_u7AD9_u76EE_u5F55" rel="external nofollow noopener noreferrer" target="_blank">在VPS上搭建hexo博客，利用git更新 - WikiLibrary</a></li>
<li><a href="http://buzhidao.me/2016/02/01/%E5%9C%A8VPS%E4%B8%8A%E9%85%8D%E7%BD%AEhexo%E5%8D%9A%E5%AE%A2/" rel="external nofollow noopener noreferrer" target="_blank">在VPS上配置hexo博客 - Springwon</a></li>
</ul>
<ul>
<li><a href="http://huifeng.me/2015/08/16/deploy-hexo-to-vps/" rel="external nofollow noopener noreferrer" target="_blank">Deploy Hexo sites to VPS - 回风.Me</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;updated: 2017-01-18&lt;/p&gt;
&lt;p&gt;因为之前的WordPress博客域名被墙，加上Hexo正好满足于简单的书写要求，所以更换为Hexo。&lt;/p&gt;
&lt;p&gt;主要还是记录了自己的搭建过程，因为对Linux不太熟悉，以备忘为主。&lt;/p&gt;
&lt;p&gt;后面换到了codin
    
    </summary>
    
    
      <category term="Hexo" scheme="https://Dvel.org/tags/Hexo/"/>
    
  </entry>
  
</feed>
