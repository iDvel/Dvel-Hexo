<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dvel&#39;s Blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://Dvel.org/"/>
  <updated>2017-01-07T15:01:55.000Z</updated>
  <id>https://Dvel.org/</id>
  
  <author>
    <name>Dvel</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>为Hexo博客弄一个图床，再搭配一个神器</title>
    <link href="https://Dvel.org/p/1/"/>
    <id>https://Dvel.org/p/1/</id>
    <published>2016-11-27T18:17:30.000Z</published>
    <updated>2017-01-07T15:01:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>图床的优点：一次上传，到处使用。</p>
<p>Markdown编辑器、自己的博客、论坛、Quiver这类的笔记本里，看图都是简单明了的。</p>
<h2 id="图床"><a href="#图床" class="headerlink" title="图床"></a>图床</h2><p>七牛、又拍、阿里云</p>
<p>新浪、imgur、sm.ms</p>
<p>很多随便选，按需求决定，我用的V2EX的，因为我图片量不大。</p>
<h2 id="图床神器-iPic"><a href="#图床神器-iPic" class="headerlink" title="图床神器 iPic"></a>图床神器 iPic</h2><p>在选择好图床后，还发现一个超级好用的软件——</p>
<p><img src="https://i.v2ex.co/933WxxrL.jpeg" alt="iPic"></p>
<p>总之就是搭配Markdown的神器啦。</p>
<ul>
<li>支持拖动上传</li>
<li>自动生成Markdown语法，插图方便</li>
<li>支持众多图床，基本主流的都支持啦</li>
<li>最神奇的出现啦：<a href="https://toolinbox.net/iPic/iPicUploader_Typora.html" rel="external nofollow noopener noreferrer" target="_blank">Typora集成了iPic的上传服务</a></li>
</ul>
<p>具体的看这里吧：<a href="https://toolinbox.net/iPic/" rel="external nofollow noopener noreferrer" target="_blank"> 图床神器 iPic </a></p>
<p><em>特效</em>，注意看地址：</p>
<p><img src="https://i.v2ex.co/dNQ05ykt.gif" alt="Typora iPic"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;图床的优点：一次上传，到处使用。&lt;/p&gt;
&lt;p&gt;Markdown编辑器、自己的博客、论坛、Quiver这类的笔记本里，看图都是简单明了的。&lt;/p&gt;
&lt;h2 id=&quot;图床&quot;&gt;&lt;a href=&quot;#图床&quot; class=&quot;headerlink&quot; title=&quot;图床&quot;&gt;&lt;/a&gt;图床&lt;
    
    </summary>
    
    
      <category term="Hexo" scheme="https://Dvel.org/tags/Hexo/"/>
    
      <category term="图床" scheme="https://Dvel.org/tags/%E5%9B%BE%E5%BA%8A/"/>
    
      <category term="iPic" scheme="https://Dvel.org/tags/iPic/"/>
    
  </entry>
  
  <entry>
    <title>你好, Hexo!</title>
    <link href="https://Dvel.org/p/0/"/>
    <id>https://Dvel.org/p/0/</id>
    <published>2016-11-26T16:48:36.000Z</published>
    <updated>2017-01-17T18:45:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>updated: 2017-01-18</p>
<p>因为之前的WordPress博客域名被墙，加上Hexo正好满足于简单的书写要求，所以更换为Hexo。</p>
<p>主要还是记录了自己的搭建过程，因为对Linux不太熟悉，以备忘为主。</p>
<p>后面换到了coding pages上搭建，主要是简单方便省心，自带了https，速度也凑合。</p>
<h1 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h1><h3 id="本地搭建"><a href="#本地搭建" class="headerlink" title="本地搭建"></a>本地搭建</h3><h4 id="安装node-js"><a href="#安装node-js" class="headerlink" title="安装node.js"></a>安装node.js</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ brew install node</div></pre></td></tr></table></figure>
<h4 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h4><p>先cd进入创建好的hexo目录：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ sudo npm install -g hexo-cli</div><div class="line">$ hexo init</div><div class="line">$ npm install</div><div class="line">$ hexo d -fg</div><div class="line">$ hexo serve</div></pre></td></tr></table></figure>
<p>打开<a href="http://localhost:4000如果看到hexo的初始页面证明安装成功。" rel="external nofollow noopener noreferrer" target="_blank">http://localhost:4000如果看到hexo的初始页面证明安装成功。</a></p>
<h4 id="ssh秘钥"><a href="#ssh秘钥" class="headerlink" title="ssh秘钥"></a>ssh秘钥</h4><p>一路回车生成公钥和私钥：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">ssh-keygen -t rsa -C &quot;email@example.com&quot;</div></pre></td></tr></table></figure>
<p>之后在本地目录<code>~/.ssh/</code>下可以看到私钥<code>id_rsa</code>和公钥<code>id_rsa.pub</code>已经生成。</p>
<p>安装ssh-copy-id等会用，方便上传公钥。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">brew install ssh-copy-id</div></pre></td></tr></table></figure>
<h3 id="VPS端搭建"><a href="#VPS端搭建" class="headerlink" title="VPS端搭建"></a>VPS端搭建</h3><h4 id="更新与安装（centOS）"><a href="#更新与安装（centOS）" class="headerlink" title="更新与安装（centOS）"></a>更新与安装（centOS）</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">yum update</div><div class="line">yum install nginx -y</div><div class="line">yum install git-core</div></pre></td></tr></table></figure>
<h4 id="创建git用户及设置ssh免密码登陆"><a href="#创建git用户及设置ssh免密码登陆" class="headerlink" title="创建git用户及设置ssh免密码登陆"></a>创建git用户及设置ssh免密码登陆</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">adduser git</div><div class="line">passwd git</div><div class="line">chmod 740 /etc/sudoers</div><div class="line">vim /etc/sudoers</div><div class="line">(提示没有安装vim的可以用vi命令，或安装vim:)</div><div class="line">yum -y install vim*</div></pre></td></tr></table></figure>
<p>在编辑器中找到以下内容并添加一行：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">## Allow root to run any commands anywhere</div><div class="line">root    ALL=(ALL)     ALL</div><div class="line">git     ALL=(ALL)     ALL (这行是添加的)</div></pre></td></tr></table></figure>
<p>保存退出并执行：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">chmod 440 /etc/sudoers</div></pre></td></tr></table></figure>
<p>接下来切到本地的终端，上传公钥：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ ssh-copy-id -i ~/.ssh/id_rsa.pub git@123.123.123.123</div></pre></td></tr></table></figure>
<p>测试一下，如果<code>$ ssh git@VPS的IP地址</code>,能够免密码登录的话，则表示成功。  </p>
<h4 id="回到VPS，创建git仓库"><a href="#回到VPS，创建git仓库" class="headerlink" title="回到VPS，创建git仓库:"></a>回到VPS，创建git仓库:</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">su git</div><div class="line">cd ~</div><div class="line">mkdir hexo.git &amp;&amp; cd hexo.git</div><div class="line">git init --bare</div></pre></td></tr></table></figure>
<h4 id="创建网站目录并赋予git对网站目录的所有权"><a href="#创建网站目录并赋予git对网站目录的所有权" class="headerlink" title="创建网站目录并赋予git对网站目录的所有权"></a>创建网站目录并赋予git对网站目录的所有权</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">su root</div><div class="line">cd /var/www</div><div class="line">mkdir hexo</div><div class="line">chown git:git -R /var/www/hexo</div></pre></td></tr></table></figure>
<h4 id="配置git-hooks"><a href="#配置git-hooks" class="headerlink" title="配置git hooks"></a>配置git hooks</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">su git</div><div class="line">cd /home/git/hexo.git/hooks</div><div class="line">vim post-receive</div></pre></td></tr></table></figure>
<p>写入以下内容：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">GIT_REPO=/home/git/hexo.git #git仓库</div><div class="line">TMP_GIT_CLONE=/tmp/hexo</div><div class="line">PUBLIC_WWW=/var/www/hexo #网站目录</div><div class="line">rm -rf $&#123;TMP_GIT_CLONE&#125;</div><div class="line">git clone $GIT_REPO $TMP_GIT_CLONE</div><div class="line">rm -rf $&#123;PUBLIC_WWW&#125;/*</div><div class="line">cp -rf $&#123;TMP_GIT_CLONE&#125;/* $&#123;PUBLIC_WWW&#125;</div></pre></td></tr></table></figure>
<p>然后赋予脚本的执行权限</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">chmod +x post-receive</div></pre></td></tr></table></figure>
<h4 id="配置Nginx"><a href="#配置Nginx" class="headerlink" title="配置Nginx"></a>配置Nginx</h4><p>启动nginX:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">systemctl status nginx.service      // 查看服务当前状态</div><div class="line">systemctl start nginx.service       // 启动nginx服务</div><div class="line">systemctl restart nginx.service     // 重新启动服务</div><div class="line"></div><div class="line">systemctl enable nginx.service      // 设置开机自启动</div><div class="line">systemctl disable nginx.service     // 停止开机自启动</div><div class="line"></div><div class="line">systemctl list-units --type=service // 查看所有已启动的服务</div></pre></td></tr></table></figure>
<p>然后：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">vim /etc/nginx/conf.d/hexo.conf</div></pre></td></tr></table></figure>
<p>插入如下代码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen         80 ;</div><div class="line">    root /var/www/hexo;//这里可以改成你的网站目录地址，我将网站放在/var/www/hexo</div><div class="line">    server_name example.com www.example.com;//这里输入你的域名或IP地址</div><div class="line">    access_log  /var/log/nginx/hexo_access.log;</div><div class="line">    error_log   /var/log/nginx/hexo_error.log;</div><div class="line">    location ~* ^.+\.(ico|gif|jpg|jpeg|png)$ &#123;</div><div class="line">            root /var/www/hexo;</div><div class="line">            access_log   off;</div><div class="line">            expires      1d;</div><div class="line">    &#125;</div><div class="line">    location ~* ^.+\.(css|js|txt|xml|swf|wav)$ &#123;</div><div class="line">        root /var/www/hexo;</div><div class="line">        access_log   off;</div><div class="line">        expires      10m;</div><div class="line">    &#125;</div><div class="line">    location / &#123;</div><div class="line">        root /var/www/hexo;//这里可以改成你的网站目录地址，我将网站放在/var/www/hexo</div><div class="line">        if (-f $request_filename) &#123;</div><div class="line">            rewrite ^/(.*)$  /$1 break;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后重启nginx，此时刷新网页应该显示的是403。</p>
<h3 id="本机的最后配置"><a href="#本机的最后配置" class="headerlink" title="本机的最后配置"></a>本机的最后配置</h3><p>位于<code>hexo</code>文件夹下，<code>_config.yml</code>,修改<code>deploy</code>选项，例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  message: update  # 这个可以不写，会默认生成update日期</div><div class="line">  repo: git@123.123.123.123:hexo.git,master # 逗号后面写分支</div></pre></td></tr></table></figure>
<p>部署到多个仓库可以这么写：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">deploy: </div><div class="line">  - type: git</div><div class="line">    repo: git@git.coding.net:Dvel/Dvel.git,master</div><div class="line">  - type: git</div><div class="line">    repo: git@github.com:iDvel/Dvel-Hexo.git,master</div></pre></td></tr></table></figure>
<p>每次更新博客也可以让github上长点绿草了。。。</p>
<p>接下来安装<strong>hexo-deployer-git</strong>，否则部署时会报这个错”<em>ERROR Deployer not found: git</em>“。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ npm install hexo-deployer-git --save</div></pre></td></tr></table></figure>
<p>接着<code>$ hexo g &amp;&amp; hexo d</code>，如果一切正常，静态文件已经被成功的push到了blog的仓库里。</p>
<p>期间我忘了还出了个什么错，删除<code>hexo</code>目录下的<code>.deploy_git</code>后再次<code>hexo g &amp;&amp; hexo d</code>就可以了。</p>
<p>以上，博客已经完全建好了。</p>
<p><code>$ hexo generate</code>是生成静态文件。</p>
<p><code>$ hexo deploy</code>是部署，我们这里选择了Git，Hexo还支持其他部署形式。</p>
<p>所以每次写完文章，执行这两个命令后，就对网站完成了更新。</p>
<p>简化操作就是：<code>$ hexo g &amp;&amp; hexo d</code> ，再简化就是<code>$ hexo d -g</code>，效果一样。</p>
<h1 id="方法二，利用一键安装包"><a href="#方法二，利用一键安装包" class="headerlink" title="方法二，利用一键安装包"></a>方法二，利用一键安装包</h1><p>因为不太熟悉Linux，所以我选择了一键安装包，多站点管理方便些。</p>
<p>我用的这个 -&gt; <a href="https://oneinstack.com/" rel="external nofollow noopener noreferrer" target="_blank">OneinStack官网</a></p>
<p>步骤和上面差不多，但是很多路径要改一下，也可以很简单的搭建出Hexo。</p>
<h1 id="方法三，coding-pages"><a href="#方法三，coding-pages" class="headerlink" title="方法三，coding pages"></a>方法三，coding pages</h1><ol>
<li><p>coding中创建项目</p>
</li>
<li><p>站点配置文件<code>_config.yml</code>中<code>deploy</code>中写好coding项目的git地址</p>
</li>
<li><p>push上去：<code>$ hexo d -g</code></p>
</li>
<li><p>在coding上你的项目，开启Pages服务：可以自定义分支，绑定域名，开启https</p>
</li>
<li><p>大功告成</p>
<p>​</p>
</li>
</ol>
<p>这个相对简单一些，Coding Pages服务目前提供100M空间的支持，一般来说没有写文章的话，生成的<code>public</code>文件夹大约小于5M。</p>
<p>100M基本够写很多年的博客，至于图片应该另寻图床，不要放到coding上，否则空间很快用完。</p>
<h1 id="编写文章、更新博客"><a href="#编写文章、更新博客" class="headerlink" title="编写文章、更新博客"></a>编写文章、更新博客</h1><p>使用一款 MarkDown 编辑器写文章 ，写完后将文件以 *.md 的格式保存在本地<code>[网站目录]\source_posts</code>中。</p>
<p>MD编辑器，强烈安利Typora。</p>
<p>每篇 Blog 都有固定的参数必须填写，参数如下，注意每个参数的 : 后都有一个空格。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">title: title</div><div class="line">date: yyyy-mm-dd</div><div class="line">categories: category  </div><div class="line">tags: tag</div><div class="line">#多标签请这样写：  </div><div class="line">#tags: [tag1,tag2,tag3]</div><div class="line">#或者这样写： </div><div class="line">#tags:</div><div class="line">#- tag1 </div><div class="line">#- tag2  </div><div class="line">#- tag3  </div><div class="line">---  </div><div class="line">正文</div></pre></td></tr></table></figure>
<p>或者使用<code>$ hexo new</code>命令，具体官网有详细说明。</p>
<p>编写完后，只需要在hexo文件夹下执行<code>hexo g &amp;&amp; hexo d</code>，博客即可更新。</p>
<h1 id="遇到的坑"><a href="#遇到的坑" class="headerlink" title="遇到的坑"></a>遇到的坑</h1><h4 id="设置了ssh免密码登陆后，依然需要密码"><a href="#设置了ssh免密码登陆后，依然需要密码" class="headerlink" title="设置了ssh免密码登陆后，依然需要密码"></a>设置了ssh免密码登陆后，依然需要密码</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">这整段是以前使用的方法，过时了。。。</div><div class="line">设置ssh免密码登陆：</div><div class="line">su git</div><div class="line">cd ~</div><div class="line">mkdir .ssh &amp;&amp; cd .ssh</div><div class="line">touch authorized_keys</div><div class="line">vim authorized_keys  //在这个文件中粘贴进刚刚申请的key（在id_rsa.pub文件中）</div><div class="line">设置权限：</div><div class="line">chmod o-w ~/</div><div class="line">chmod 700 ~/.ssh</div><div class="line">chmod 600 ~/.ssh/authorized_keys</div><div class="line"></div><div class="line">测试免密码登陆</div><div class="line">ssh -vvT git@123.123.123.123   // 你的VPS的IP地址</div><div class="line">发现依然需要密码，搜了好几天没找到解决办法，后来采用了ssh-copy-id，解决了这个问题。</div></pre></td></tr></table></figure>
<h4 id="tip"><a href="#tip" class="headerlink" title="tip"></a>tip</h4><p>如果过程中重新初始化过VPS的磁盘，ssh连接VPS的时候可能会提示<code>Host key verification failed.</code>。<br>运行此命令即可：<code>$ ssh-keygen -R 123.123.123.123</code>，将123.123.123.123改成你的VPS的IP。<br>或者简单粗暴直接删除<code>known_hosts</code>文件。</p>
<h1 id="参考-amp-感谢"><a href="#参考-amp-感谢" class="headerlink" title="参考&amp;感谢"></a>参考&amp;感谢</h1><ul>
<li><a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo官网</a></li>
<li><a href="http://tiktoking.github.io/2016/01/26/hexo/#u521B_u5EFA_u7F51_u7AD9_u76EE_u5F55" rel="external nofollow noopener noreferrer" target="_blank">在VPS上搭建hexo博客，利用git更新 - WikiLibrary</a></li>
<li><a href="http://buzhidao.me/2016/02/01/%E5%9C%A8VPS%E4%B8%8A%E9%85%8D%E7%BD%AEhexo%E5%8D%9A%E5%AE%A2/" rel="external nofollow noopener noreferrer" target="_blank">在VPS上配置hexo博客 - Springwon</a></li>
</ul>
<ul>
<li><a href="http://huifeng.me/2015/08/16/deploy-hexo-to-vps/" rel="external nofollow noopener noreferrer" target="_blank">Deploy Hexo sites to VPS - 回风.Me</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;updated: 2017-01-18&lt;/p&gt;
&lt;p&gt;因为之前的WordPress博客域名被墙，加上Hexo正好满足于简单的书写要求，所以更换为Hexo。&lt;/p&gt;
&lt;p&gt;主要还是记录了自己的搭建过程，因为对Linux不太熟悉，以备忘为主。&lt;/p&gt;
&lt;p&gt;后面换到了codin
    
    </summary>
    
    
      <category term="Hexo" scheme="https://Dvel.org/tags/Hexo/"/>
    
  </entry>
  
</feed>
